<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	  template="/public/template_initial.xhtml">
 
	<!-- TOP BAR DEFINE -->
	<ui:define name="top_bar">
		<ui:include src="/public/top_bar-admin.xhtml"/>
	</ui:define>
  
  	<!-- NAV BAR DEFINE -->
	<ui:define name="nav_bar">
		<ui:include src="/public/nav_bar-admin.xhtml"/>
	</ui:define>	

	<!-- CONTENT DEFINE -->
	<ui:define name="page_content">	
	
		<div id="content">

        	<div class="container">

	        	<div class="row">
	
			        <div class="col-md-12">
			            <ul class="breadcrumb">
			                <li>
			                	<a href="#">Home</a>
			                </li>
			                <li>
			                	<a href="./pesquisa-produto.xhtml">Produto</a>
			                </li>
			                <li>
			                	Edição de Grade
			                </li>				                
			            </ul>
			        </div>
			 	</div>
			 	<!-- /.row -->   
			 	
			 	<h:form id="frm-cadastro">
			 	
				 	<div class="row" id="row-cadastro"> 	
	
		                <div class="col-md-9">
		                
							<h:messages 
					    	  	id="messages"
						      	errorClass="alert alert-block alert-danger fade in"
						      	infoClass="alert alert-block alert-success fade in"
					     	 	style="padding-left:0px"
					     	 	globalOnly="true"/>		                
		
		                    <div class="box" id="box-cadastro">
		        	
		        				<h3>Cadastro de produto</h3>
		        	
								<div class="row">
					                <div class="col-md-12">
						
										<h:inputHidden
						            		value="#{editaGradeDoProdutoBean.produto.codigo}"/>
										
										<div class="col-sm-6"> 
											<div class="form-group">
						                        
					                            <label for="input-cod-interno">Código externo</label>
					                            <h:inputText 
					                            	pt:type="text" 
					                            	class="form-control" 
					                            	id="input-cod-interno" 
					                            	pt:placeholder="Código"
					                            	value="#{editaGradeDoProdutoBean.produto.codigoInterno}"
					                            	readonly="true"/>
						                 	</div>
						            	</div>
						            	
					                    <div class="col-sm-8">    
					                        <div class="form-group">
					                        
					                            <label for="input-descricao">Descrição</label>
					                            <h:inputText
					                            	class="form-control" 
					                            	id="input-descricao" 
					                            	pt:placeholder="Descrição"
					                            	value="#{editaGradeDoProdutoBean.produto.descricao}"
					                            	readonly="true"/>
					                            	
					                        </div>
										</div>		
										
					                    <div class="col-sm-8">    
					                        <div class="form-group">
					                        
					                            <label for="input-departamento">Departamento</label>
					                            <h:inputText
					                            	class="form-control" 
					                            	id="input-departamento" 
					                            	pt:placeholder="Departamento"
					                            	value="#{editaGradeDoProdutoBean.produto.departamento.descricao}"
					                            	readonly="true"/>
					                            	
					                        </div>
										</div>											
										
					                    <div class="col-sm-8">    
					                        <div class="form-group">
					                        
					                            <label for="input-tipo">Tipo</label>
					                            <h:inputText
					                            	class="form-control" 
					                            	id="input-tipo" 
					                            	pt:placeholder="Tipo do produto"
					                            	value="#{editaGradeDoProdutoBean.produto.tipoProduto.descricao}"
					                            	readonly="true"/>
					                            	
					                        </div>
										</div>	
										
					                    <div class="col-sm-8">    
					                        <div class="form-group">
					                        
					                            <label for="input-composicao">Composição</label>
					                            <h:inputText
					                            	class="form-control" 
					                            	id="input-composicao" 
					                            	pt:placeholder="Tipo do produto"
					                            	value="#{editaGradeDoProdutoBean.produto.composicao.descricao}"
					                            	readonly="true"/>
					                            	
					                        </div>
										</div>											
					                    
					                    <div class="col-sm-8">    
					                        <div class="form-group">
					                        
					                            <label for="input-subgrupo">Subgrupo</label>
					                            <h:inputText
					                            	class="form-control" 
					                            	id="input-subgrupo" 
					                            	pt:placeholder="Subgrupo do produto"
					                            	value="#{editaGradeDoProdutoBean.produto.subgrupo}"
					                            	readonly="true"/>
					                            	
					                        </div>
										</div>		
										
					                    <div class="col-sm-8">    
					                        <div class="form-group">
					                        
					                            <label for="input-grade-atual">Grade atual</label>
					                            <h:inputText
					                            	class="form-control" 
					                            	id="input-grade-atual" 
					                            	pt:placeholder="Grade atual do produto"
					                            	value="#{editaGradeDoProdutoBean.produto.tipoGrade.descricao}"
					                            	readonly="true"/>
					                            	
					                        </div>
										</div>											

			                        	<div class="col-sm-12 text-center">                        
					                        <h:commandButton
					                        	class="btn btn-primary"
					                        	action="#{editaGradeDoProdutoBean.salvar()}"
					                        	value="Salvar">
					                        	
					                        	<f:ajax
					                        		execute="@this"
					                        		render="frm-cadastro"/>
				                        	</h:commandButton>
			                        	</div>
					    			</div><!-- /.col-md-12 -->
			                         
			                	</div><!-- /.row -->
						    
						    </div><!-- /.box-cadastro -->
						</div><!-- /#col-md-row -->
						
					</div> <!-- /.row row-cadastro -->
					
					<div class="row" id="row-troca-grade"> <!--  -->
	
						<div class="col-md-9">
		
		                    <div class="box" id="box-troca-grade">
		        	
		        				<h3>Troca de grade</h3>
		        	
		        				<h:panelGroup
		        					id="panel-troca-grade">
		        					
									<div class="row">
						                <div class="col-md-12">
						                
							   				<h:messages 
									    	  	id="messages-troca-grade"
										      	errorClass="alert alert-block alert-danger fade in"
										      	infoClass="alert alert-block alert-success fade in"
									     	 	style="padding-left:0px"
									     	 	globalOnly="true"/>								                
							
											<h:inputHidden
							            		value="#{editaGradeDoProdutoBean.grade.codigo}"/>

						                    <div class="col-sm-6">    
						                        <div class="form-group">
						                        
						                            <label for="input-grade-atual-troca">Grade atual</label>
						                            <h:inputText
						                            	class="form-control" 
						                            	id="input-grade-atual-troca" 
						                            	pt:placeholder="Grade atual do produto"
						                            	value="#{editaGradeDoProdutoBean.produto.tipoGrade.descricao}"
						                            	readonly="true"/>
						                            	
						                        </div>
											</div>								            		

											<div class="col-sm-6">    
						                        <div class="form-group">
						                        
						                            <label for="select-tipo-grade">Nova grade <span class="required">*</span></label>
						                          	<h:selectOneMenu 
						                          		styleClass="form-control"
						                          		id="select-tipo-grade"
						                          		valueChangeListener="#{editaGradeDoProdutoBean.handleSelecaoDeTipoGrade}"
						                          		disabled="#{not editaGradeDoProdutoBean.produto.podeAlterarGrade()}">
						                          		
						                          		<f:selectItem 
						                          			itemLabel="Selecione a nova grade do produto"
						                          			noSelectionOption="true"/>
						                          			
						                          		<f:selectItems
						                          			value="#{editaGradeDoProdutoBean.tiposGrades}"
						                          			var="tipo"
						                          			itemLabel="#{tipo.descricao}"
						                          			itemValue="#{tipo}"/>
						                          		
						                          		<f:ajax
						                          			execute="@this"
						                          			event="change"/>
						                          	</h:selectOneMenu>  
		
									                <h:message 
									                   	id="m_select-tipo-grade" 
									                   	for="select-tipo-grade"
									                   	class="alert-danger fade in"/>				                          	
						                          	
						                        </div>
						                    </div>	
						                    
				                        	<div class="col-sm-12 text-center">                        
						                        <h:commandButton
						                        	class="btn btn-primary"
						                        	action="#{editaGradeDoProdutoBean.transformaGradeDoProduto()}"
						                        	value="Trocar grade"
						                        	disabled="#{not editaGradeDoProdutoBean.produto.podeAlterarGrade()}">

						                        	<f:ajax
						                        		execute="@form"
						                        		render="@form"/>
					                        	</h:commandButton>
				                        	</div>						                    
						                    
						    			</div><!-- /.col-md-12 -->
				                         
				                	</div><!-- /.row -->
				                </h:panelGroup> <!-- /#panel-troca-grade -->
				                
						    </div><!-- /.box-cadastro -->
						</div><!-- /#col-md-row -->
					
					</div> <!-- /.row row-troca-grade -->						                        				
					
					<div class="row" id="row-grade"> <!--  -->
	
						<div class="col-md-9">
		
		                    <div class="box" id="box-cadastro">
		        	
		        				<h3>Grade do produto</h3>
		        	
		        				<h:panelGroup
		        					id="panel-grade">
		        					
									<div class="row">
						                <div class="col-md-12">
						                
							   				<h:messages 
									    	  	id="messages-grade"
										      	errorClass="alert alert-block alert-danger fade in"
										      	infoClass="alert alert-block alert-success fade in"
									     	 	style="padding-left:0px"
									     	 	globalOnly="true"/>								                
							
											<h:inputHidden
							            		value="#{editaGradeDoProdutoBean.grade.codigo}"/>

						                    <div class="col-sm-6">    
						                        <div class="form-group">
						                        
						                            <label for="select-grade-cor">Cor <span class="required">*</span></label>
						                          	<h:selectOneMenu 
						                          		styleClass="form-control"
						                          		value="#{editaGradeDoProdutoBean.grade.cor}"
						                          		id="select-grade-cor"
						                          		rendered="#{(editaGradeDoProdutoBean.produto.tipoGrade == 'COR') or (editaGradeDoProdutoBean.produto.tipoGrade == 'COR_E_TAMANHO')}">
						                          		
						                          		<f:selectItem 
						                          			noSelectionOption="true"/>
						                          			
						                          		<f:selectItems
						                          			value="#{editaGradeDoProdutoBean.cores}"
						                          			var="cor"
						                          			itemLabel="#{cor.descricao}"
						                          			itemValue="#{cor}"/>
						                          		
						                          	</h:selectOneMenu>  						                            
						                            
						                        </div>
											</div>		
							            	
						                    <div class="col-sm-6">    
						                        <div class="form-group">
						                        
						                            <label for="select-grade-tam">Tamanho <span class="required">*</span></label>
						                          	<h:selectOneMenu 
						                          		styleClass="form-control"
						                          		value="#{editaGradeDoProdutoBean.grade.tamanho}"
						                          		id="select-grade-tam"
						                          		rendered="#{(editaGradeDoProdutoBean.produto.tipoGrade == 'TAMANHO') or (editaGradeDoProdutoBean.produto.tipoGrade == 'COR_E_TAMANHO')}"
						                          		immediate="true">
						                          		
						                          		<f:selectItem 
						                          			noSelectionOption="true"/>
						                          			
						                          		<f:selectItems
						                          			value="#{editaGradeDoProdutoBean.tamanhos}"
						                          			var="tam"
						                          			itemLabel="#{tam.descricao}"
						                          			itemValue="#{tam}"/>
						                          			
						                          		<f:ajax
						                          			execute="@this"/>						                          			
						                          		
						                          	</h:selectOneMenu>  						                            
						                            
						                        </div>
											</div>	
											
											<div class="col-sm-6">    
						                        <div class="form-group">
						                        
						                            <label for="input-grade-letra">Letra</label>
						                            <h:inputText
						                            	class="form-control" 
						                            	id="input-grade-letra" 
						                            	pt:placeholder="Letra da grade"
						                            	value="#{editaGradeDoProdutoBean.grade.letra}"
						                            	rendered="#{editaGradeDoProdutoBean.produto.tipoGrade == 'LETRA'}">
						                            	
						                            	<f:ajax 
									                        event="blur" 
									                        render="m_input-grade-letra" />
									                        	
									              	</h:inputText>
									                    
									                <h:message 
									                   	id="m_input-grade-letra" 
									                   	for="input-grade-letra"
									                   	class="alert-danger fade in"/>
						                            	
						                        </div>
											</div>													
											
											<div class="col-sm-6">    
						                        <div class="form-group">
						                        
						                            <label for="input-localizacao">Localização</label>
						                            <h:inputText
						                            	class="form-control" 
						                            	id="input-localizacao" 
						                            	pt:placeholder="Localização no estoque"
						                            	value="#{editaGradeDoProdutoBean.grade.localizacao}">
						                            	
						                            	<f:ajax 
									                        event="blur" 
									                        render="m_input-localizacao" />
									                        	
									              	</h:inputText>
									                    
									                <h:message 
									                   	id="m_input-localizacao" 
									                   	for="input-localizacao"
									                   	class="alert-danger fade in"/>
						                            	
						                        </div>
											</div>												            	
	
				                        	<div class="col-sm-12 text-center">                        
						                        <h:commandButton
						                        	class="btn btn-primary"
						                        	action="#{editaGradeDoProdutoBean.adicionaItem()}"
						                        	value="#{editaGradeDoProdutoBean.edicaoDeItem ? 'Alterar' : 'Adicionar'}"
						                        	disabled="#{editaGradeDoProdutoBean.produto.tipoGrade eq null}">

						                        	<f:ajax
						                        		execute="@form"
						                        		render="frm-cadastro"/>
					                        	</h:commandButton>
				                        	</div>
						    			</div><!-- /.col-md-12 -->
				                         
				                	</div><!-- /.row -->
				                </h:panelGroup> <!-- /#panel-grade -->
				                
						    </div><!-- /.box-cadastro -->
						</div><!-- /#col-md-row -->
					
					</div> <!-- /.row row-grade -->
					
					<div class="row" id="row-lista-de-grades"> <!--  -->
					
						<h:panelGroup
							id="panel-lista-grades">
	
							<div class="col-md-9">
	
								<div class="box">
					
				                    <div class="table-responsive">
				                        <table class="table table-striped table-advance table-hover">
				                            <thead>
				                                <tr>
				                                    <th style="width:150px">Tipo de grade</th>
				                                    <th style="width:150px">Cor</th>
				                                    <th style="width:100px">Tamanho</th>
				                                    <th style="width:80px">Letra</th>
				                                    <th style="width:180px">Localização</th>
				                                    <th style="text-align: right">Controle</th>
				                                </tr>
				                            </thead>
				                            
				                            <tbody>
				                            
												<ui:repeat 
													var="grade" 
												   	value="#{editaGradeDoProdutoBean.produto.grades}">		                          
													<tr>
													   <td>#{grade.tipoDeGrade().descricao}</td>
													   <td>
													   		<h:outputText 
													   			value="#{grade.cor.descricao}"
													   			rendered="#{(grade.tipoDeGrade() == 'COR') or (grade.tipoDeGrade() == 'COR_E_TAMANHO')}"/>
													   </td>
													   
													   <td>
													   		<h:outputText 
													   			value="#{grade.tamanho.descricao}"
													   			rendered="#{(grade.tipoDeGrade() == 'TAMANHO') or (grade.tipoDeGrade() == 'COR_E_TAMANHO')}"/>
													   </td>	
	
													   <td>
													   		<h:outputText 
													   			value="#{grade.letra}"
													   			rendered="#{grade.tipoDeGrade() == 'LETRA'}"/>
													   </td>													   
													   
													   <td>#{grade.localizacao}</td>											   
													   
													   <td style="text-align: right">
														   <div class="btn-group" >
																<a class="btn btn-warning" 
																	jsfc="h:commandLink"
																	type="button"
																	action="#{editaGradeDoProdutoBean.editaItem()}"
																	disabled="#{editaGradeDoProdutoBean.produto.tipoGrade ne grade.tipoDeGrade()}">
														        	
														        	<f:setPropertyActionListener 
														        		value="#{grade}" 
														        		target="#{editaGradeDoProdutoBean.gradeSelecionada}"/>
														        	
														        	<f:ajax
									                        			execute="@this"
									                        			render="@form"/>
														        	
																	<i class="icon_check_alt2"></i>
														        </a>
														        
																<a class="btn btn-danger" 
																	jsfc="h:commandLink"
																	type="button"
																	immediate="true">
												                  
														        	<f:setPropertyActionListener 
														        		value="#{grade}" 
														        		target="#{editaGradeDoProdutoBean.gradeSelecionada}"/>
												                   												        	
												                   <f:passThroughAttribute name="data-toggle" value="modal" />
												                   <f:passThroughAttribute name="data-target" value="#myModal" />
												                   <f:ajax/>
																
																	<i class="icon_close_alt2"></i>
																</a>
														    </div>
													    </td>
													</tr>
												</ui:repeat>		                            
		
		                                    </tbody>
		                                </table>
			
			                       	</div>
			                        <!-- /.table-responsive -->
			                  	</div> 
			                  	<!-- /#box -->						
							
							</div>
							
						</h:panelGroup> <!-- panel-lista-grades -->
					</div>	<!-- /.row-lista-de-grades -->
					
					<div class="row" id="modal-exclusao">
		            	
		            	<div class="col-md-12">
		                            
							<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModal" aria-hidden="true" data-keyboard="false" data-backdrop="static">
						    	<div class="modal-dialog modal-md">
						        	<div class="modal-content">
						                	<div class="modal-header">
						                		<button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>
						                    	<h4 class="modal-title">Confirmação de exclusão</h4>
						                	</div>
						                	<div class="modal-body">
						                		<h:panelGroup 
							                		layout="block" 
							                		id="panelDescricao-grade">
							                	
							                		Deseja realmente excluir a grade selecionada?
							                		<div 
				                						style="text-align:right"
				                						id="btns-confirm-grade">
								                	
								                		<a  type="submit"
								                			class="btn btn-warning btn-sm"
								                			jsfc="h:commandLink"
								                			action="#{editaGradeDoProdutoBean.removeItem()}">
								                			Sim
														
															<f:passThroughAttribute name="data-dismiss" value="modal" />
															<f:ajax
										               			execute="@this"
										               			render="@all"/>
														</a>
							                		
							                			<button 
							                				id="close-grade"
							                				type="submit" 
							                				class="btn btn-info btn-sm">Não</button>
							                		</div>
							                		<!-- /.btns-confirm -->
							                		
						                		</h:panelGroup>
						                	</div>
						
						        	</div>
						    	</div>
							</div>	
		                        
		                </div>
		                <!-- /.col-md-12 -->
		         	
		         	</div>
		         	<!-- /.row modal-exclusao-->		
		         	
				</h:form>
			
			</div><!-- /.container -->
    	
    	</div> 
		<!-- /#content -->
		
	</ui:define>
	<!-- END OF DEFINE CONTENT -->
	
	<!-- DEFINE FOOTER -->
	<ui:define name="footer">
	</ui:define>
	<!-- END OF DEFINE FOOTER -->
	   
	<!-- DEFINE SCRIPT -->
	<ui:define name="script">
	</ui:define>
	<!-- END OF DEFINE SCRIPT -->			
			
</ui:composition>
